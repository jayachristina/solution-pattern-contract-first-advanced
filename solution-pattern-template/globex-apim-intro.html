<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: Solution Patterns for Cloud Native Architectures</title>
    <link rel="canonical" href="https://redhat-solution-patterns.github.io/solution-patterns/solution-pattern-template/globex-apim-intro.html">
    <meta name="generator" content="Antora 3.0.0">
    <link rel="stylesheet" href="../_/css/site.css">
<link rel="icon" href="../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <body class="article">
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9TW8CJFT3N"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9TW8CJFT3N');
</script>
<!-- Google tag (gtag.js) -->

<header class="header">
  <script type="text/javascript">
    document.addEventListener('DOMContentLoaded', function () { 
      const urlParams = new URLSearchParams(window.location.search);
      const userId = urlParams.get('USERID');
      const subdomain = urlParams.get('SUBDOMAIN'); 
      if (userId) {
        showUserId( userId, subdomain);
      }
      else {
        showUserIdForm(subdomain);
      }
    } );


    function showUserId( userId, subdomain) {
      document.getElementById('navbar-form-empty').style.display = "none";
      document.getElementById('navbar-form-filled').style.display = "flex";
      document.getElementById('userIdDisplay').textContent = "User ID : " + userId;
      document.getElementById('subdomainDisplay').textContent = "Subdomain : " + subdomain; 
    }

    function showUserIdForm( subdomain ) {
      document.getElementById('navbar-form-empty').style.display = "flex";
      document.getElementById('navbar-form-filled').style.display = "none";
      document.getElementById('subdomain').value = subdomain; 

    }

    function goWithUserId() {
      elUserIdInput = document.getElementById('userId');
      elSubdomainInput = document.getElementById('subdomain');
      window.location.search = ('&USERID=' + elUserIdInput.value  + '&SUBDOMAIN=' + elSubdomainInput.value);
    }

    function recycle() {
      document.getElementById('userId').value='';
      document.getElementById('subdomain').value='';
      window.location.search = ('');
    }


  </script>
  <nav class="navbar">
   <div class="navbar-brand">
      <a class="navbar-item" style="font-size: 20px; color: white" href="https://redhat-solution-patterns.github.io/solution-patterns">
        <img src="../_/img/logo.png" height="35px" alt="Solution Patterns">&nbsp; Solution Patterns for Cloud Native Architectures</a>
      <button class="navbar-burger" data-target="topbar-nav">
      </button>
      
    </div>
    <div class="navbar-item" ><span class="navbar-text" style="color: white; margin-left: 1rem; margin-right: 1rem;">|</span></div>
    
    <div class="navbar-item has-dropdown is-hoverable" >
      <a class="navbar-link" href="#" style="color: white">Red Hat Patterns</a>
      <div class="navbar-dropdown">
        <a class="navbar-item" href="https://www.redhat.com/architect/portfolio/" target="_blank">Portfolio Architecture&nbsp; </a>
        <a class="navbar-item" href="https://redhat-solution-patterns.github.io/solution-patterns/patterns.html" target="_blank">Solution Patterns </a>
        <a class="navbar-item" href="https://validatedpatterns.io/" target="_blank">Validated Patterns&nbsp;</a>

      </div>
    </div>
    <div class="navbar-item has-dropdown is-hoverable" >
      <a class="navbar-link" href="#" style="color: white">Resources</a>
      <div class="navbar-dropdown">
        <a class="navbar-item" target="_blank" href="https://www.redhat.com/en/products/application-foundations">Red Hat Application Services</a>
        <a class="navbar-item" target="_blank" href="https://developers.redhat.com/app-dev-platform">App Dev Platform</a>
      </div>
    </div>

    <div class="navbar-item" ><span class="navbar-text" style="color: white; margin-left: 1rem; margin-right: 1rem;">|</span></div>


    

    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        


        <div class="navbar-item" id="navbar-form-empty">
          <span class="navbar-text" style="margin-left: 2rem;">
          <span class="navbar-text" style="margin-left: 1rem; margin-right: 1rem;">&nbsp;<i style="color: orange;"
              class="fa fa-exclamation-triangle" aria-hidden="true"></i></span>
            Your Workshop Environment

          <form action="javascript:void(0);" onsu>
            <input size="20" id="userId" type="text" placeholder="USER ID">
            <input size="20" id="subdomain" type="text" placeholder="Subdomain">
            <button type="hidden" onclick="goWithUserId();">Set</button>
          </form>
        </div>
        
        <div class="navbar-item" id="navbar-form-filled" style="display: none;">
          <span class="navbar-text" style="margin-left: 2rem;">
          <span class="navbar-text " style="margin-left: 1rem; margin-right: 1rem; float:left">
            &nbsp;Your Workshop Environment <span class="navbar-text" style="margin-left: 1rem; margin-right: 1rem;">&nbsp;<i alt="Clear details" title="Clear details" onclick="recycle();" style="color: green;" class="fa fa-recycle" aria-hidden="true"></i>

          <br><span  id="userIdDisplay"></span> <span  style="color: white; margin-left: 1rem; margin-right: 1rem;">|</span>
          <span id="subdomainDisplay"></span>
        </div>

        
        </span>

    </div>
  </nav>
</header><div class="body">
<div class="nav-container" data-component="solution-pattern-template" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html" class=" query-params-link">Contract First approach - Advanced with OIDC</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">1. Home page</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html#use-cases">1.1 Use cases</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#01-pattern.adoc#_the_story_behind_this_solution_pattern">1.2 The story behind this solution pattern</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#01-pattern.adoc#_the_solution">1.3 The solution</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html#_content_overview">1.4 Content Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html#_content_overview">1.5 Explore more solution patterns</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="02-architecture.html">2. Architecture</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-architecture.html#tech_stack">2.1. Technology stack</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-architecture.html#in_depth">2.2. An in-depth look at the solution&#8217;s architecture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-architecture.html#tech_stack">2.3. More about the technology stack</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="03-demo.html">3. Solution in Action</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-demo.html#_demonstration">3.1. Demonstration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="03-demo.html#_run_the_demonstration">3.2. Run this demonstration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="03-demo.html#_before_getting_started">3.3. Pre-requisites</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="03-demo.html#_installing_the_demo">3.4. Installing the demo</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="03-demo.html#_walkthrough_guide">3.5. Walkthrough guide</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="developer-resources.html">4. Developer Resources</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#05-appendix.adoc">5. Appendix</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://redhat-solution-patterns.github.io/">Other Red Hat Solution Patterns</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Contract First approach - Advanced with OIDC</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Contract First approach - Advanced with OIDC</span>
      <ul class="versions">
        <li class="version is-current">
          <a href="index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
</nav>
  <div class="edit-this-page"><a href="https://github.com/jayachristina/solution-pattern-contract-first-advanced/edit/main/documentation/modules/ROOT/pages/globex-apim-intro.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<div class="paragraph">
<p>In this module you discover how Contract First Approach provides the right framework to acclerate launching new channels in a secure way across internal and external teams to build microservices and APIs based systems.</p>
</div>
<div class="sect1">
<h2 id="_business_context"><a class="anchor" href="#_business_context"></a>Business context</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As mentioned in the introduction module of the workshop, Globex went through a modernization phase for their retail web application, moving from a legacy monolith to a containerized application. With their growing popularity, Globex would like to add new channels to their existing, web-based e-commerce application.</p>
</div>
<div class="paragraph">
<p>They are working towards launching their own <strong>Globex Mobile App</strong> and  partnering with other large retail portals. This requires formalizing the application API definitions and exposing the APIs through a API Management solution for consumption by the Globex Mobile App and by Partner Portals.</p>
</div>
<div class="paragraph">
<p><strong>(a) Mobile App</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Globex would like to launch a mobile application as well in addition to the retail web-site. Globex does not have the necessary expertise in mobile development, so development will have to be outsourced.</p>
</li>
<li>
<p>This means that, the mobile application will also need secure access to the Globex APIs</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>(b) Partner Portal</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Retail partner aggregators would like to showcase Globex&#8217;s product catalogue on their website</p>
</li>
<li>
<p>To allow for this access, Globex would like to expose an API to allow access to their APIs</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_technical_considerations"><a class="anchor" href="#_technical_considerations"></a>Technical considerations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The new requirements to expand Globex&#8217;s business by adding additional channels bring its own set of challenges</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Lack of a standardised API format makes it a serious challenge in gaining access the data needed from Globex</p>
</li>
<li>
<p>Launching a  Mobile App is  difficult because it would be tightly coupled with the e-commerce retail application&#8217;s core services</p>
</li>
<li>
<p>Inter-dependencies between various teams during the dev phase can slow down the dev productivity and time to market.</p>
</li>
<li>
<p>Lack of governance and inadvertent changes to the services can lead to adverse effect on the dev teams</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Globex decides to adopt a <strong>Contract First approach</strong> before tackling the development of new services with the API contract being formalized in as OpenAPI specifications.  With <strong>Contract-First</strong>, all the relevant parties including the Globex core team, internal teams, mobile teams, and 3rd party partner aggregators are on the same page before writing the first line of code.  Once a first version of the OpenAPI spec document is ready, it is pushed and managed in a service registry, which acts a the system of truth. Mocks are created for the API so as to enable parallel development streams.</p>
</div>
<details>
<summary class="title"><span class="underline"><strong>[Click to know] What is an OpenAPI?</strong></span></summary>
<div class="content">
<div class="paragraph">
<p>The OpenAPI Specification (OAS) provides a consistent means to carry information through each stage of the API lifecycle. It is a specification language for HTTP APIs that defines structure and syntax in a way that is not wedded to the programming language the API is created in. API specifications are typically written in YAML or JSON, allowing for easy sharing and consumption of the specification.</p>
</div>
</div>
</details>
<div class="paragraph">
<p>The team introduces <strong>Red Hat 3scale API management</strong>  to expose, secure and manage the APIs to the core application backend services.</p>
</div>
<div class="paragraph">
<p>To make this a reality a number of components are brought together to realise the final solution</p>
</div>
<div class="sect2">
<h3 id="_red_hat_sso"><a class="anchor" href="#_red_hat_sso"></a>Red Hat SSO</h3>
<div class="paragraph">
<p>Globex uses Red Hat SSO to provide single sign-on (SSO) capabilities to Users, Web apps and APIs. In this case, OpenID Connect is used to authenticate a user (Globex Web and Mobile users) and also allow secured access to Globex&#8217;s APIs</p>
</div>
<details>
<summary class="title"><span class="underline"><strong>[Click to know] What is an OpenID Connect?</strong></span></summary>
<div class="content">
<div class="paragraph">
<p>OpenID Connect (OIDC) is a simple identity layer on top of the popular OAuth framework (i.e. it verifies the user by obtaining basic profile information and using an authentication server).</p>
</div>
<div class="paragraph">
<p>It is built on top of OAuth 2.0 that complements the OAuth 2.0 Authorization framework with an authentication mechanism. When OpenID Connect authentication option is used, the API requests are authenticated using the access tokens in the JSON Web Token (JWT) format (<a href="https://tools.ietf.org/html/rfc7519">RFC 7519</a>).</p>
</div>
</div>
</details>
</div>
<div class="sect2">
<h3 id="_api_designer"><a class="anchor" href="#_api_designer"></a>API Designer</h3>
<div class="paragraph">
<p>Red Hat API Designer based on Apicurio provides web based API Designer tool. You will use this a draft OpenAPI file from your local file system and visually edit it (and then save it back to your disk)!</p>
</div>
</div>
<div class="sect2">
<h3 id="_service_registry"><a class="anchor" href="#_service_registry"></a>Service Registry</h3>
<div class="paragraph">
<p>Publish the OpenAPIs and makes the OpenAPIs accessible. The REST endpoint of the artifact (APIs) is used to create ActiveDocs within the API Management platform.</p>
</div>
<details>
<summary class="title"><span class="underline"><strong>Click to learn amore about Service Registry</strong></span></summary>
<div class="content">
<div class="paragraph">
<p>Service Registry is a datastore for sharing standard event schemas and API designs across API and event-driven architectures. You can use Service Registry to decouple the structure of your data from your client applications, and to share and manage your data types and API descriptions at runtime using a REST interface.</p>
</div>
<div class="paragraph">
<p>You can upload new artifacts, new versions, view the metadata, download the specs, view documentation and view the content as well. Through Content rules one can validate new versions of the APIs against the existing specs to ensure validity and backward compatibility.</p>
</div>
<div class="paragraph">
<p>Service Registry acts as the single source of truth for the OpenAPI Specifications. This spec can be used to share and manage the data types and API descriptions at runtime using a REST interface with internal teams and other external developers and partners.</p>
</div>
</div>
</details>
</div>
<div class="sect2">
<h3 id="_3scale_api_management"><a class="anchor" href="#_3scale_api_management"></a>3scale API Management</h3>
<div class="paragraph">
<p>Red Hat 3scale API Management platform is used to publish, manage and secure the backend APIs. API Management helps you to define, deploy, consume, or publish your APIs for use by other developers, channels and partners. In this workshop, you will work with OpenID Connect to secure the APIs.</p>
</div>
<div class="paragraph">
<p>Mobile developers and Partners can sign up to APIs via the 3scale Developer Portal, and also track their usage through analytics.<br></p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/3scale-architecture.png" alt="3scale architecture" width="80%">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_backend_services"><a class="anchor" href="#_backend_services"></a>Backend Services</h3>
<div class="paragraph">
<p>Not all of Globex&#8217;s services are made available in the first iteration for access by Mobile and Partners. The Backend For Frontend (BFF) services are generated based on the OpenAPI Specs</p>
</div>
<details>
<summary class="title"><span class="underline"><strong>Click to learn more about Code Generation</strong></span></summary>
<div class="content">
<div class="ulist">
<ul>
<li>
<p>The server-side code for the <a href="https://github.com/rh-cloud-architecture-workshop/globex-mobile-gateway/blob/main/src/main/java/org/globex/gateway/mobile/rest/MobileCatalogResource.java" target="code-samples">Mobile Gateway</a> has been built using the <a href="https://mvnrepository.com/artifact/io.apicurio/apicurio-codegen-quarkus-extension" target="code-samples">Apicurio Codegen Quarkus Extension</a></p>
</li>
<li>
<p>You can use the <a href="https://github.com/quarkiverse/quarkus-openapi-generator" target="code-samples">Quarkus extension from Quarkiverse</a> to generate Rest Clients based on OpenAPI specification files.</p>
</li>
</ul>
</div>
</div>
</details>
</div>
<div class="sect2">
<h3 id="_mobile_app"><a class="anchor" href="#_mobile_app"></a>Mobile App</h3>
<div class="paragraph">
<p>For the first iteration, the Mobile App is built using Angular + NodeJS. This app uses <a href="https://github.com/damienbod/angular-auth-oidc-client" target="code-samples">angular-auth-oidc-client</a> to enable user SSO.</p>
</div>
</div>
<div class="sect2">
<h3 id="_a_graphical_representation_of_the_architecture"><a class="anchor" href="#_a_graphical_representation_of_the_architecture"></a>A graphical representation of the architecture:</h3>
<div class="imageblock">
<div class="content">
<img src="_images/apim_deployment.png" alt="apim deployment">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation"><a class="anchor" href="#_implementation"></a>Implementation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the next chapter, you will be guided through the implementation and deployment of the Contract First Approach. Of course this entails way more than can be achieved during a workshop, so instead most components are already in place, and you will focus on a number of key activities to deploy and run the solution.</p>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <img
          src="../_/img/app-services-logo.png" height="40px" alt="Cloud Native Architecture Solution Patterns"  href="https://redhat.com" ></a>
</footer><script src="../_/js/vendor/clipboard.js"></script>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
